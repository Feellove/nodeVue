webpackJsonp([5],{"7ST+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("GKy3");var c=a("4vvA"),n=a.n(c),s=a("mtWM"),o=a.n(s),i=a("1GZU"),r=a.n(i),l=a("cxpW"),d={components:{tabBar:a("/Rkq").a},data:function(){return{checked:!1,show:!1,checkedGoods:[],editState:!1,completeState:!1,cartsSate:!1,value:1,postVal:2,carts:[],totalMoney:""}},created:function(){this.show=this.$route.query.show,this.initCart()},filters:{moneyFilter:function(t){return Object(l.a)(t)},totalFilter:function(t,e){return totalMoney(t,e)}},computed:{totalPrice:function(){var t=this;return this.carts.reduce(function(e,a){return e+(-1!==t.checkedGoods.indexOf(a)?100*a.PRICE*a.NUM:0)},0)}},methods:{onClickLeft:function(){this.$router.go(-1)},edit:function(){this.editState=!0,this.completeState=!0},completeEdit:function(){this.editState=!1,this.completeState=!1},initCart:function(){var t=this;o()({url:r.a.checkCart,method:"post"}).then(function(e){200==e.data.code&&e.data.message?(t.carts=e.data.message,0===t.carts.length&&(t.cartsSate=!0),console.log(t.carts)):n()("服务器错误，数据取得失败")}).catch(function(t){console.log(t)})},changeNum:function(t,e){var a=this,c=this.$refs.stepValue[e].$data.currentValue,s=t;o()({url:r.a.updateCart,method:"post",data:{cartId:s,num:c}}).then(function(t){200==t.data.code&&t.data.message?(console.log(t.data.message),a.carts=t.data.message):n()("服务器错误，数据取得失败")}).catch(function(t){console.log(t)})},setCheckSingle:function(t){},setCheckAll:function(t){this.checkedGoods=t?this.carts.map(function(t){return t}):[]},cartSubmit:function(){this.$router.push({name:"order",params:{checkedGoods:this.checkedGoods,totalPrice:this.totalPrice}})},cartDel:function(){var t=this;console.log(this.checkedGoods),o()({url:r.a.deleteCart,method:"post",data:{deleteData:this.checkedGoods}}).then(function(e){200==e.data.code&&e.data.message?t.initCart():n()("服务器错误，数据取得失败")}).catch(function(t){console.log(t)})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"navBar"},[t.completeState?a("van-nav-bar",{attrs:{title:"购物车","right-text":"完成",fixed:""},on:{"click-right":t.completeEdit}}):a("van-nav-bar",{attrs:{title:"购物车",fixed:""},on:{"click-right":t.edit}},[a("van-icon",{attrs:{slot:"right",name:"edit"},slot:"right"})],1)],1),t._v(" "),a("div",{staticClass:"shoppingContent"},[a("van-checkbox-group",{on:{change:t.setCheckSingle},model:{value:t.checkedGoods,callback:function(e){t.checkedGoods=e},expression:"checkedGoods"}},t._l(t.carts,function(e,c){return a("van-row",{key:c},[a("van-col",{attrs:{span:"3"}},[a("div",{staticClass:"singleCheck"},[a("van-checkbox",{key:e.ID,attrs:{name:e}})],1)]),t._v(" "),a("van-col",{attrs:{span:"7"}},[a("div",{staticClass:"singleImg"},[a("img",{attrs:{src:e.IMAGE,height:"80%"}})])]),t._v(" "),a("van-col",{attrs:{span:"14"}},[a("div",{staticClass:"singleContent"},[a("span",{staticClass:"singleTitle"},[t._v(t._s(e.NAME))]),t._v(" "),a("span",{staticClass:"singlePrice"},[t._v("￥"+t._s(t._f("moneyFilter")(e.PRICE)))]),t._v(" "),a("span",{staticClass:"singleStepper"},[a("van-stepper",{ref:"stepValue",refInFor:!0,attrs:{"default-value":e.NUM},on:{change:function(a){t.changeNum(e.ID,c)}}})],1)])])],1)}))],1),t._v(" "),t.cartsSate?a("div",{staticStyle:{"font-size":"0.6rem",color:"#ccc","text-align":"center"}},[a("van-icon",{staticStyle:{"font-size":"1.28rem"},attrs:{name:"cart"}}),t._v("\n    购物车为空，请先选择心仪的商品加入\n  ")],1):a("div",[t.editState?a("div",{staticClass:"account"},[a("van-submit-bar",{staticStyle:{bottom:"2.13rem"},attrs:{"button-text":"删除"},on:{submit:t.cartDel}},[a("van-checkbox",{staticStyle:{padding:"0 0.6rem"},on:{change:t.setCheckAll},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("全选")])],1)],1):a("div",{staticClass:"account"},[a("van-submit-bar",{staticStyle:{bottom:"2.13rem"},attrs:{price:t.totalPrice,"button-text":"去结算"},on:{submit:t.cartSubmit}},[a("van-checkbox",{staticStyle:{padding:"0 0.6rem"},on:{change:t.setCheckAll},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("全选")])],1)],1)]),t._v(" "),a("tab-bar",{attrs:{postVal:t.postVal}})],1)},staticRenderFns:[]};var h=a("VU/8")(d,u,!1,function(t){a("ApRW"),a("fEn4")},"data-v-7e1e7c3a",null);e.default=h.exports},ApRW:function(t,e){},fEn4:function(t,e){}});
//# sourceMappingURL=5.1360643e1b7a6432a890.js.map